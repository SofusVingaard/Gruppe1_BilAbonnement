<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Finansrapporter</title>
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/financeReport.css}">
    <link rel="stylesheet" th:href="@{/css/payFinanceReport.css}">
</head>
<body>
<header>
    <div th:replace="~{fragments/header.html :: site-header}"></div>
</header>

<main style="margin-left: 240px; padding: 20px;">

    <form th:action="@{/financeReport}" method="get" style="margin-bottom: 20px;">
        <label for="phone">Søg efter kundes telefonnummer:</label>
        <input type="number" id="phone" name="phone" required>
        <button type="submit">Søg</button>
    </form>

    <div th:if="${searchedAgreement != null}" class="searched-agreement-box">
        <h3>Lejeaftale fundet:</h3>
        <p><strong>ID:</strong> <span th:text="${searchedAgreement.id}"></span></p>
        <p><strong>Kunde:</strong> <span th:text="${searchedAgreement.customer.name}"></span></p>
        <p><strong>Telefon:</strong> <span th:text="${searchedAgreement.customer.phoneNumber}"></span></p>
        <p><strong>Totalpris:</strong> <span th:text="${searchedAgreement.totalPrice} + ' DKK'"></span></p>
    </div>

    <section class="finance-report-section">
        <div class="finance-report-header">
            <h2>Finansrapporter</h2>
            <a th:href="@{/create}" class="finance-report-button">+ Opret Finansrapport</a>
        </div>

        <table class="finance-report-table">
            <thead>
            <tr>
                <th>ID</th>
                <th>Dato</th>
                <th>Lejepris</th>
                <th>Km over grænse</th>
                <th>Skade-ID</th>
                <th>Totalpris</th>
                <th>Status</th>
                <th>Handling</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="report : ${reports}">
                <td th:text="${report.id}"></td>
                <td th:text="${report.date}"></td>
                <td th:text="${report.rentalFee} + ' DKK'"></td>
                <td th:text="${report.kmOverLimit} + ' km'"></td>
                <td th:text="${report.damageReportId}"></td>
                <td th:text="${report.totalPrice} + ' DKK'"></td>
                <td th:text="${report.paid ? 'Betalt' : 'Ikke betalt'}"></td>
                <td>
                    <a th:if="${!report.paid}" th:href="@{'/financeReport/pay/' + ${report.id}}" class="finance-report-button">Betal</a>
                    <span th:if="${report.paid}">✔</span>
                </td>
            </tr>
            </tbody>
        </table>
    </section>
</main>
</body>
</html>
